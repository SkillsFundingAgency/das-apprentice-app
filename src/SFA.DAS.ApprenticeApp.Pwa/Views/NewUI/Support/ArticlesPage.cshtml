@model SFA.DAS.ApprenticeApp.Pwa.ViewModels.SupportArticlesPageModel
@{
    ViewData["Title"] = Model.CategoryPage?.First().Heading;
    ViewData["Section"] = "Support";
    Layout = "_Layout";
}

@section BackLink {
    <a asp-action="Index" asp-controller="Support" class="govuk-back-link app-back-link">Back</a>
}
<h1 class="govuk-heading-xl">@Model.CategoryPage?.First().Heading</h1>
<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        <div class="govuk-accordion" data-module="govuk-accordion" id="accordion-default">
            @foreach (var item in Model.Articles.OrderBy(x => x.ArticleOrder))
            {
                <div class="govuk-accordion__section">
                    <div class="govuk-accordion__section-header">
                        <h2 class="govuk-accordion__section-heading">
                            <span class="govuk-accordion__section-button" id="accordion-default-heading-1">
                                @item.Heading
                            </span>
                        </h2>
                    </div>
                    <div id="accordion-default-content-@item.Id" class="govuk-accordion__section-content">
        
                        @if (item.Content != null)
                        {
                            <div class="govuk-body">@Html.Raw(item.ArticleText)</div>
                        }
                        else
                        {
                            <div class="govuk-body">No content was found for this article</div>
                        }
        
                        <div class="app-article-actions">
                            @if (Model.ApprenticeArticles != null)
                            {
                                var isSaved = Model.ApprenticeArticles.Any(x => x.EntryId == item.Id && x.IsSaved == true);
                                @if (isSaved)
                                {
                                    <button class="app-article-actions__button unsave" data-title="@item.Heading">
                                        <span class="icon">
                                            <svg width="24" height="24">
                                                <use href="/assets/icons/sprite.svg#pin-filled"></use>
                                            </svg>
                                        </span>
                                        <span class="text">Remove<span class="govuk-visually-hidden"> "@item.Heading" from your saved articles</span></span>
                                    </button>
                                }
                                else
                                {
                                    <button class="app-article-actions__button save" data-title="@item.Heading">
                                        <span class="icon">
                                            <svg width="24" height="24">
                                                <use href="/assets/icons/sprite.svg#pin"></use>
                                            </svg>
                                        </span>
                                        <span class="text">Save<span class="govuk-visually-hidden"> "@item.Heading" to your saved articles</span></span>
                                    </button>
                                }
                            }
        
                            <button class="app-article-actions__button share-btn">
                                <span class="icon">
                                    <svg width="24" height="24">
                                        <use href="/assets/icons/sprite.svg#share"></use>
                                    </svg>
                                </span>
                                <span class="text">Share<span class="govuk-visually-hidden"> "@item.Heading"</span></span>
                            </button>
                        </div>
        
                        <input class="article-title" type="hidden" value="@item.Heading" />
                        <input class="entryid" type="hidden" value="@item.Id" />
        
                    </div>
                </div>
            }
        </div>
    </div>
</div>

<script src="~/js/article-actions.js" asp-append-version="true"></script>